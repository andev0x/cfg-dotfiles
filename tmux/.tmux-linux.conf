### ========================
### TMUX CONFIG (ARCH LINUX)
### ANVNDEV — FINAL / OPTIMIZED
### ========================

##### General #####
set -g mouse on
set -s escape-time 0
set -g history-limit 100000
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set-option -g focus-events on

##### Truecolor #####
set -g default-terminal "tmux-256color"
set -as terminal-overrides ",ghostty:Tc,xterm-256color:Tc"

##### Vi Mode #####
setw -g mode-keys vi


### ========================
### Smart Vim / Tmux Navigation
### ========================

is_vim="ps -o comm= -t '#{pane_tty}' | grep -iqE 'n?vim|view|fzf'"

bind -n M-h if-shell "$is_vim" "send-keys M-h" "select-pane -L"
bind -n M-j if-shell "$is_vim" "send-keys M-j" "select-pane -D"
bind -n M-k if-shell "$is_vim" "send-keys M-k" "select-pane -U"
bind -n M-l if-shell "$is_vim" "send-keys M-l" "select-pane -R"

bind -n M-H resize-pane -L 5
bind -n M-L resize-pane -R 5
bind -n M-J resize-pane -D 2
bind -n M-K resize-pane -U 2


### ========================
### Floating Popup Terminal
### ========================

bind -n M-f display-popup -E -w 80% -h 80% \
  -d "#{pane_current_path}" "zsh -l"


### ========================
### Status Bar (macOS-style UI)
### ========================

set -g status-position bottom
set -g status-interval 5        # Efficient, low CPU
set -g status-justify left
set -g status-style bg=default,fg=white

##### LEFT — Session (ICON KEPT EXACTLY) #####
set -g status-left-length 30
set -g status-left "#[fg=#a6e3a1,bg=default]#[fg=#1e1e2e,bg=#a6e3a1,bold]#[fg=#a6e3a1,bg=#313244]#[fg=#cdd6f4,bg=#313244] #S #[fg=#313244,bg=default] "

##### Windows #####
setw -g window-status-separator ""

setw -g window-status-format "#[fg=#89b4fa,bg=default]#[fg=#1e1e2e,bg=#89b4fa]#I#[fg=#89b4fa,bg=#313244]#[fg=#cdd6f4,bg=#313244] #W #[fg=#313244,bg=default]"

setw -g window-status-current-format "#[fg=#fab387,bg=default]#[fg=#1e1e2e,bg=#fab387,bold]#I#[fg=#fab387,bg=#313244]#[fg=#cdd6f4,bg=#313244,bold] #W #[fg=#313244,bg=default]"


### ========================
### Status Right (FAST / ARCH SAFE)
### ========================

set -g status-right-length 150
set -g status-right "\
#[fg=#f9e2af,bg=default]#[fg=#1e1e2e,bg=#f9e2af]#[fg=#f9e2af,bg=#313244]\
#[fg=#cdd6f4,bg=#313244] #(git -C #{pane_current_path} rev-parse --abbrev-ref HEAD 2>/dev/null || basename #{pane_current_path}) \
#[fg=#313244,bg=default] \
#[fg=#94e2d5,bg=default]#[fg=#1e1e2e,bg=#94e2d5]#[fg=#94e2d5,bg=#313244]\
#[fg=#cdd6f4,bg=#313244] #(awk 'NR==1{u=$2+$4;t=$2+$4+$5} NR==2{printf \"%d%%\", (u-$2-$4)*100/(t-$2-$4-$5)}' /proc/stat) \
#[fg=#313244,bg=default] \
#[fg=#f5c2e7,bg=default]#[fg=#1e1e2e,bg=#f5c2e7]#[fg=#f5c2e7,bg=#313244]\
#[fg=#cdd6f4,bg=#313244] #(whoami) \
#[fg=#313244,bg=default] \
#[fg=#a6e3a1,bg=default]#[fg=#1e1e2e,bg=#a6e3a1]󱛡#[fg=#a6e3a1,bg=#313244]\
#[fg=#cdd6f4,bg=#313244] %H:%M \
#[fg=#313244,bg=default]"


### ========================
### Pane & Message Styling
### ========================

set -g window-style 'fg=#626880,bg=default'
set -g window-active-style 'fg=#cdd6f4,bg=default'

set -g pane-border-style "fg=#313244"
set -g pane-active-border-style "fg=#89b4fa"

set -g message-style "fg=#fab387,bg=#313244,bold"


### ========================
### Keybindings
### ========================

bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

bind r source-file ~/.tmux.conf \; display-message "tmux reloaded"

bind x kill-pane
bind X kill-window
bind Q kill-session


### ========================
### Clipboard (Wayland / Arch)
### ========================

bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "wl-copy"


